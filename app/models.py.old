from sqlalchemy import Column, Integer, String, Date, Numeric, ForeignKey
from sqlalchemy.orm import relationship
from .database import Base

class Facture(Base):
    __tablename__ = "facture"

    id_facture = Column(Integer, primary_key=True, index=True)
    numero_facture = Column(String, nullable=False)
    date_facture = Column(Date, nullable=False)
    code_client = Column(String, nullable=False)

    lignes = relationship("LigneFacture", back_populates="facture", cascade="all, delete")


class LigneFacture(Base):
    __tablename__ = "ligne_facture"

    id_ligne = Column(Integer, primary_key=True)
    id_facture = Column(Integer, ForeignKey("facture.id_facture", ondelete="CASCADE"))
    nom_produit_facture = Column(String(100), nullable=False)
    quantite = Column(Integer, nullable=False)
    prix_unitaire_ht = Column(Numeric(10, 2), nullable=False)
    taux_tva = Column(Numeric(5, 2), nullable=False)

    facture = relationship("Facture", back_populates="lignes")
